# Level 1
## Predict category from title

Unzip xml files
```sh 
gunzip /workspace/search_with_machine_learning_course/*/*.xml.gz
```


The file `createContentTrainingData.py` reads XML source files, do some manipulation in data and produces the training dataset.

```sh 
python week3/createContentTrainingData.py --output /workspace/datasets/categories/output.fasttext --min_products 100
```

Creates the train data and the test data from data previously generated by `createContentTrainingData.py`
```sh 
head -n -10000  /workspace/datasets/categories/output.fasttext | shuf -n 10000  > /workspace/datasets/categories/data.train

tail -n -10000  /workspace/datasets/categories/output.fasttext | shuf -n 10000  > /workspace/datasets/categories/data.test
```

Generated/train the model 
```sh 
/workspace/fastText-0.9.2/fasttext supervised -input /workspace/datasets/categories/data.train -output /workspace/datasets/categories/your_model -lr 1.0 -epoch 25 -wordNgrams 2
```

Test manually the result of the model
```sh 
../fastText-0.9.2/fasttext predict /workspace/datasets/categories/your_model.bin -
```

Test the model over all test data
```sh 
../fastText-0.9.2/fasttext test /workspace/datasets/categories/your_model.bin /workspace/datasets/categories/data.test
```

# Level 2
## 

```sh 
python week3/extractTitles.py --sample_rate 0.2
```

Generate/train the model
```sh 
../fastText-0.9.2/fasttext skipgram -input /workspace/datasets/fasttext/titles.txt -output /workspace/datasets/fasttext/title_model -minCount 50
```

Test manually the results. Establish a set of 20 tokens that you’ll use for evaluation. 
In order to get a good overall sense, you’ll want some variety: 
e.g., 5 product types (e.g., headphones), 5 brands (e.g., sony), 5 models (e.g., thinkpad) and 5 attributes (e.g., black). 
Remember that the catalog has a wide variety of consumer electronics (we’ve only removed music and movies), 
so try to cover a bunch of ground! Your evaluation will be subjective, but you should still be able to see as you iterate
whether your synonyms are getting better or worse.
```sh 
../fastText-0.9.2/fasttext nn /workspace/datasets/fasttext/title_model.bin
```

# Level 3

Extract titles
```sh
python week3/extractTitles.py --input /workspace/search_with_machine_learning_course/week3/phone_products --sample_rate 1.0
```

Generate/train the model
```sh 
../fastText-0.9.2/fasttext skipgram -input /workspace/datasets/fasttext/titles.txt -output /workspace/datasets/fasttext/title_model -minCount 10 -epoch 25
```

Play with this using “fasttext nn” to decide the threshold you want to use for synonyms. You’ll probably want a value of at least 0.90.
```sh 
../fastText-0.9.2/fasttext nn /workspace/datasets/fasttext/title_model.bin
```

Run logstash to build annotations field
```sh 
./index-annotations.sh
```

# Level 4

```sh
python week3/createReviewLabels.py --output /workspace/datasets/reviews/output.fasttext
```

```sh 
head -n -10000  /workspace/datasets/reviews/output.fasttext | shuf -n 10000  > /workspace/datasets/reviews/data.train

tail -n -10000  /workspace/datasets/reviews/output.fasttext | shuf -n 10000  > /workspace/datasets/reviews/data.test
```